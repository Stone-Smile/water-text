<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #waterMark {
            border: 1px solid #f00;
            position: absolute;
            top: -188px;
            left: 0;
            /* transform: rotate(30deg) */
        }
        canvas {
            border: 1px solid #ff0;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <canvas id="waterMark" width="750" height="750"></canvas>
    <!-- <canvas id="waterMark" width='"+screen.width+"px' height='"+screen.height+"px'></canvas> -->
    <!-- <canvas id="waterMark" style="width:100%; height:100%"></canvas> -->
    <p id="waterText">water Text</p>
    <p>看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果
            看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果
            看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果
            看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果
            看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果看看水印效果
    </p>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.8.3.min.js"></script>
    <script>
        // var myCanvas = "<canvas id="waterMark" width='"+screen.width+"px' height='"+screen.height+"px'></canvas>"
        // document.body.insetAdjjacentHTML('beforeEnd', myCanvas)
        // var myCanvas = document.createElement('canvas');
        // myCanvas.setAttribute('width', screen.availWidth);
        // myCanvas.setAttribute('height', screen.availHeight)
        // myCanvas.setAttribute('id', 'myCanvas');
        // document.body.appendChild(myCanvas);
        var waterImg = document.getElementById('waterMark');
        var waterText = document.getElementById('waterText');
        var ctx = waterImg.getContext('2d');
        // 认识canvas
        // ctx .fillStyle = "#ff0";
        // ctx.fillRect(0, 0, 150, 75)
        // ctx.globalAlpha = .5;
        // ctx.font = '20px PingFangSC-regular';
        // // ctx.font = '40px Arial';
        // ctx.fillText('Hello world', 50, 50);
        // ctx.strokeText('Hello world', 100, 100);

        // 水印初步实现
        // angle = 30 * Math.PI/180;
        // ctx.rotate(angle);
        // ctx.globalAlpha = .3;
        // var x, y;
        // for(x = 0; x <= 750; x += (100)) {
        //     for (y = 0; y <= 7500; y += (100)) {
        //         ctx.fillText('hello', x, y);
        //         ctx.fillText('hello', x + 50, y + 50)
        //     }
        // }
        // ctx.rotate(-angle);
        
        // 密铺水印
        ctx.fillStyle = '#ff0';
        ctx.globalAlpha = .3;
        ctx.font = '20px Arial';
        // ctx.font = '20px';
        angle = 30 * Math.PI/180;
        cvsHeight = waterImg.height * 1.4;
        cvsWidth = waterImg.width * 1.4;
        xGap = 20 * waterText.textContent.length;
        yGap = 20 * 8;
        ctx.rotate(-angle);
        var x, y;
        for (x = -cvsWidth; x <= cvsWidth; x += (xGap)) {
            for (y = -cvsHeight; y <= cvsHeight; y += (yGap)) {
                ctx.fillText(waterText.textContent, x, y);
                ctx.fillText(waterText.textContent, x + xGap/2, y + yGap/2);
            }
        }
        ctx.rotate(angle);

        // 上面并不能实现响应式，以下实现响应式
        $(window).resize(resizeCanvas);
        function resizeCanvas () {
            // canvas.attr('width', $(window).get(0).innerWidth);
            // $(canvas).attr('width', $(window).get(0).innerWidth);
            // $(canvas).attr('height', $(window).get(0).innerHeight);
            // $('#waterImg').attr('width', $(window).get(0).innerWidth);
            // $('#waterImg').attr('height', $(window).get(0).innerHeight);
            // waterImg.width = document.getElement.clientWidth || document.body.clientWidth;
            // waterImg.height = document.getElement.clientHeight || document.body.clientHeight;
            // waterImg.width = document.body.clientWidth;
            // waterImg.height = document.body.clientHeight;
            // context.fillRect(0, 0, canvas.width(), canvas.height());
            // ctx.fillRect(0, 0, waterImg.width, waterImg.height);
        }
        resizeCanvas()
    </script>
</body>
</html>